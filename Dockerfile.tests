FROM library/alt:p10
ENV container=docker

RUN rm -rf /etc/apt/sources.list.d/* /etc/apt/sources.list \
    && echo \
      'rpm [p10] http://download.basealt.ru/pub/distributions/ALTLinux p10/branch/x86_64 classic' >> \
      /etc/apt/sources.list \
    && echo \
      'rpm [p10] http://download.basealt.ru/pub/distributions/ALTLinux p10/branch/x86_64 debuginfo' >> \
      /etc/apt/sources.list \
    && echo \
      'rpm [p10] http://download.basealt.ru/pub/distributions/ALTLinux p10/branch/noarch classic' >> \
      /etc/apt/sources.list \
    && sed -i 's/^%_install_langs .*/# &/g' /etc/rpm/macros \
    && echo '%_install_langs en_US:fr:C' >> /etc/rpm/macros \
    && rm -rf /usr/lib/locale/ \
    && find /usr/share/locale -mindepth 1 -maxdepth 1 \
        ! -name en_GB \
        -exec rm -rv {} \; \
    && apt-get update \
    && apt-get dist-upgrade -y \
    && apt-get install -y branding-xalt-kworkstation-release \
    && apt-get install -y glibc-locales \
    && apt-get install -y su sudo systemd chrony apt-repo \
        docker-ce \
    && echo 'Yes, do as I say!' | apt-get install --force-yes systemd-sysvinit \
    && apt-get clean \
    && find /var/lib/apt/lists/ -type f -exec rm "{}" \; \
    && rm -rf /var/cache/apt/*.bin \
    && sed -i 's/^devpts[[:space:]]/# &/' /etc/fstab \
    && control sudo public \
    && control sudowheel enabled \
    && systemctl enable chronyd \
    && sed -i 's/mesg n/mesg n >\/dev\/null 2>\&1/g' /root/.bash_profile

ENTRYPOINT [ "/sbin/init" ]
